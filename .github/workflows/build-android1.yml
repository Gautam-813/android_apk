name: Debug WhisperSphere Build

on:
  workflow_dispatch:

jobs:
  debug:
    runs-on: ubuntu-latest
    
    steps:
    - name: Checkout Repository
      uses: actions/checkout@v4
    
    - name: Check Repository Contents
      run: |
        echo "ğŸ” Repository root contents:"
        ls -la
        echo ""
        echo "ğŸ” Looking for final_apk folder:"
        if [ -d "final_apk" ]; then
          echo "âœ… final_apk folder found"
          ls -la final_apk/
        else
          echo "âŒ final_apk folder NOT found"
          echo "Available folders:"
          find . -type d -maxdepth 2
        fi
    
    - name: Check Android Project Structure
      run: |
        if [ -d "final_apk" ]; then
          echo "ğŸ“ final_apk structure:"
          find final_apk -type f -name "*.gradle" -o -name "*.xml" -o -name "*.java" | head -20
          
          echo ""
          echo "ğŸ“‹ Checking build.gradle files:"
          find final_apk -name "build.gradle" -exec echo "=== {} ===" \; -exec cat {} \;
          
          echo ""
          echo "ğŸ“‹ Checking AndroidManifest.xml:"
          find final_apk -name "AndroidManifest.xml" -exec echo "=== {} ===" \; -exec cat {} \;
        else
          echo "âŒ Cannot check - final_apk folder missing"
        fi
    
    - name: Check if android_app folder exists instead
      run: |
        echo "ğŸ” Looking for android_app folder:"
        if [ -d "android_app" ]; then
          echo "âœ… android_app folder found"
          ls -la android_app/
          
          if [ -d "android_app/final_apk" ]; then
            echo "âœ… Found final_apk inside android_app"
            ls -la android_app/final_apk/
          fi
        else
          echo "âŒ android_app folder NOT found"
        fi
    
    - name: Show All Available Files
      run: |
        echo "ğŸ“ All files in repository:"
        find . -type f -name "*.gradle" -o -name "*.xml" -o -name "*.java" -o -name "*.py" | head -30
